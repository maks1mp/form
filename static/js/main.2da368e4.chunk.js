(this["webpackJsonpdynamic-form"]=this["webpackJsonpdynamic-form"]||[]).push([[0],{302:function(e,t,n){"use strict";n.r(t);var r,c,a=n(0),i=n.n(a),s=n(24),l=n.n(s),u=n(12),o=n(8),d=n(13),j=n.n(d),b=n(19);!function(e){e.product="product",e.serialNumber="serialNumber",e.date="date",e.file="file",e.textInput="textInput",e.email="email",e.country="country",e.state="state",e.phone="phone",e.dropdown="dropdown",e.checkboxes="checkboxes"}(r||(r={})),function(e){e.product="product",e.customer="customer"}(c||(c={}));var O=n(94),f=n(10),h=n(132),p=n.n(h),v=n(15),x=n(3),m=function(e){var t=e.name,n=e.id,r=e.values;return Object(x.jsxs)(v.b,{as:"select",name:t,id:n,children:[Object(x.jsx)("option",{}),r.map((function(e){return Object(x.jsx)("option",{value:e.value,label:e.label,children:e.label},e.id)}))]})},y=function(e){var t=e.name,n=e.values,r=e.id;return Object(x.jsx)("div",{role:"group",id:r,children:n.map((function(e){return Object(x.jsxs)("label",{children:[Object(x.jsx)("span",{children:e.label}),Object(x.jsx)(v.b,{type:"radio",id:e.id,name:t,value:e.value})]},e.id)}))})},g=function(e){var t=e.id,n=e.label,r=e.field,c=e.form,i=Object(a.useState)(""),s=Object(o.a)(i,2),l=s[0],u=s[1],d=Object(a.useState)(""),O=Object(o.a)(d,2),f=O[0],h=O[1],p=Object(a.useState)(!1),v=Object(o.a)(p,2),m=v[0],y=v[1],g=Object(a.useState)(!1),w=Object(o.a)(g,2),C=w[0],k=w[1],S=Object(a.useCallback)(Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){console.log("Fake api call..."),setTimeout((function(){Math.random()<.5?e({valid:!0}):e({valid:!1})}),2e3)})));case 1:case"end":return e.stop()}}),e)}))),[]),F=Object(a.useCallback)(Object(b.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(l),u(""),k(!0),e.next=5,S();case 5:t=e.sent,n=t.valid,c.setFieldValue(r.name,n?l:""),y(n),k(!1);case 10:case"end":return e.stop()}}),e)}))),[l,r.name,c,S]);return Object(x.jsxs)("div",{children:[f&&Object(x.jsxs)("div",{children:[Object(x.jsx)("b",{children:f})," ",Object(x.jsx)("span",{children:C?"Checking...":m?"OK":"FAILURE"})," ",Object(x.jsx)("button",{onClick:function(){h(""),c.setFieldValue(r.name,"")},children:"Clear"})]}),Object(x.jsxs)("label",{children:[Object(x.jsx)("span",{children:n}),Object(x.jsx)("input",{disabled:Boolean(f),type:"text",onKeyDown:function(e){e&&"Enter"===e.key&&F()},onBlur:F,onChange:function(e){return u(e.target.value)},value:l,id:t})]})]})},w=n(128),C=function(e){var t=e.country,n=e.field,r=e.form,c=e.disabled,i=Object(a.useState)([]),s=Object(o.a)(i,2),l=s[0],u=s[1];function d(){return(d=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("states.json",{cache:"force-cache"});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,t&&t in r&&u(Object.entries(r[t]).map((function(e){var t=Object(o.a)(e,2);return{value:t[0],label:t[1]}}))),e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){!function(e){d.apply(this,arguments)}(t)}),[r,n,t]),Object(x.jsx)(w.a,{options:l,name:n.name,value:n.value,onChange:function(e){r.setFieldValue(n.name,e)},isDisabled:Boolean(c)})},k=n(53),S=n(37);function F(e){return e.reduce((function(e,t){return Object(f.a)(Object(f.a)({},e),{},Object(k.a)({},t.name,t.default||""))}),{})}function q(e){var t=e.reduce((function(e,t){var n=S.a((function(e){return t.type===r.product&&t.required?S.c().required("".concat(t.label," is a required field")).nullable():t.type===r.email&&t.required?S.d().email("Invalid email").required("".concat(t.label," is a required field")):t.required?S.d().required("".concat(t.label," is a required field")):S.b()}));return Object(f.a)(Object(f.a)({},e),{},Object(k.a)({},t.name,n))}),{});return S.c().shape(t)}n(251);var D=n(95),I=function(e){var t=e.fields,n=e.handleSubmit,c=e.children,a=function(e){return Object(x.jsxs)(x.Fragment,{children:[e.description&&Object(x.jsx)("div",{children:e.description}),Object(x.jsx)(v.a,{name:e.name})]})};return Object(x.jsx)(v.d,{initialValues:F(t),validationSchema:q(t),onSubmit:function(e){n(e)},children:function(e){return Object(x.jsxs)(v.c,{style:{marginBottom:30,marginTop:30},onSubmit:e.handleSubmit,children:[Object(x.jsx)(x.Fragment,{children:t.map((function(t){var n=[t.id,t.name,t.label].join("");switch(t.type){case r.textInput:case r.phone:case r.email:return Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{children:Object(x.jsxs)("label",{children:[Object(x.jsx)("span",{children:t.label}),Object(x.jsx)(v.b,{name:t.name})]})}),a(t)]},n);case r.serialNumber:return Object(x.jsxs)("div",{children:[Object(x.jsx)(v.b,Object(f.a)({component:g},t)),a(t)]},n);case r.file:return Object(x.jsxs)("div",{children:[Object(x.jsx)("label",{children:t.label}),Object(x.jsx)("div",{children:Object(x.jsx)("input",{accept:t.accept,type:t.type,name:t.name,onChange:function(n){var r,c;e.setFieldValue(t.name,null===n||void 0===n||null===(r=n.target)||void 0===r||null===(c=r.files)||void 0===c?void 0:c[0])}})}),a(t)]},n);case r.checkboxes:var c=t.options,i=Object(O.a)(t,["options"]);return Object(x.jsxs)("div",{children:[Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{children:t.label}),Object(x.jsx)(y,Object(f.a)(Object(f.a)({},i),{},{values:c}))]}),a(t)]},n);case r.dropdown:var s=t.options,l=Object(O.a)(t,["options"]);return Object(x.jsxs)("div",{children:[Object(x.jsxs)("label",{children:[Object(x.jsx)("span",{children:t.label}),Object(x.jsx)(m,Object(f.a)(Object(f.a)({},l),{},{values:s}))]}),a(t)]},n);case r.date:var u=e.values[t.name];return Object(x.jsxs)("div",{children:[Object(x.jsxs)("label",{children:[Object(x.jsx)("span",{children:t.label}),Object(x.jsx)(p.a,{selected:u?new Date(u):null,dateFormat:"MMMM d, yyyy",className:"form-control",name:"startDate",onChange:function(n){n&&e.setFieldValue(t.name,n.toString())}})]}),a(t)]},n);case r.product:return Object(x.jsxs)("div",{children:[Object(x.jsxs)("label",{children:[Object(x.jsx)("span",{children:t.label}),Object(x.jsx)(v.b,Object(f.a)(Object(f.a)({},t),{},{render:function(e){var t=e.field,n=e.form;return Object(x.jsx)(D.a,{cacheOptions:!0,formatOptionLabel:function(e){var t;return Object(x.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(x.jsx)("img",{width:32,src:null===e||void 0===e||null===(t=e.image)||void 0===t?void 0:t.src,alt:""}),Object(x.jsx)("span",{children:null===e||void 0===e?void 0:e.title})]})},isClearable:!0,defaultOptions:!0,name:t.name,value:t.value||"",isOptionSelected:function(e,t){return t.some((function(t){return t.variantId===e.variantId}))},onChange:function(e){return n.setFieldValue(t.name,e)},loadOptions:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("search.json?q=".concat(t));case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})}}))]}),a(t)]},n);case r.country:return Object(x.jsxs)("div",{children:[Object(x.jsxs)("label",{children:[Object(x.jsx)("span",{children:t.label}),Object(x.jsx)(v.b,Object(f.a)(Object(f.a)({},t),{},{render:function(e){var t=e.form,n=e.field;return Object(x.jsx)(D.a,{cacheOptions:!0,defaultOptions:!0,name:n.name,defaultValue:n.value,onChange:function(e){t.setFieldValue("state",""),t.setFieldValue(n.name,e.value)},loadOptions:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("countries.json",{cache:"force-cache"});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",Object.entries(r).filter((function(e){var n=Object(o.a)(e,2);n[0];return n[1].toLowerCase().includes(t.toLowerCase())})).map((function(e){var t=Object(o.a)(e,2);return{value:t[0],label:t[1]}})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})}}))]}),a(t)]},n);case r.state:var d,h,w=null!==(d=null===(h=e.values)||void 0===h?void 0:h.country)&&void 0!==d?d:"";return Object(x.jsxs)("div",{children:[Object(x.jsxs)("label",{children:[Object(x.jsx)("span",{children:t.label}),Object(x.jsx)(v.b,Object(f.a)(Object(f.a)({},t),{},{country:w,render:function(e){return Object(x.jsx)(C,Object(f.a)({country:w},e))},disabled:!Boolean(w)}))]}),a(t)]},n);default:return Object(x.jsxs)("div",{children:["Not implemented field ",t.type]},n)}}))}),c]})}})},V=function(){var e,t,n,r=function(){var e=Object(a.useState)(),t=Object(o.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(),i=Object(o.a)(c,2),s=i[0],l=i[1],u=Object(a.useState)(!1),d=Object(o.a)(u,2),O=d[0],f=d[1],h=Object(a.useCallback)(Object(b.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.prev=1,e.next=4,fetch("form.json");case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,r(n),l(null),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),r(null),l(e.t0);case 16:return e.prev=16,f(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[1,12,16,19]])}))),[]);return Object(a.useEffect)((function(){h()}),[h]),{formData:n,error:s,loading:O}}(),i=r.formData,s=r.loading,l=r.error,d=Object(a.useState)(),O=Object(o.a)(d,2),f=O[0],h=O[1],p=Object(a.useState)(!1),v=Object(o.a)(p,2),m=v[0],y=v[1];return s?Object(x.jsx)("div",{children:"Loading..."}):l?Object(x.jsx)("div",{children:"Error..."}):i?Object(x.jsxs)(x.Fragment,{children:[f&&Array.isArray(f)&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("table",{style:{border:"solid",borderCollapse:"collapse",marginBottom:20},width:"100%",children:[Object(x.jsx)("thead",{children:Object(x.jsx)("tr",{children:null===(e=i.find((function(e){return e.name===c.product})))||void 0===e?void 0:e.fields.map((function(e){return Object(x.jsx)("th",{style:{border:"solid"},children:e.label},e.id)}))})}),Object(x.jsx)("tbody",{children:f.map((function(e,t){return Object(x.jsx)("tr",{children:Object.values(e).map((function(e,t){return Object(x.jsx)("td",{style:{border:"solid"},children:"object"===typeof e?e.name:e},t)}))},t)}))})]}),Object(x.jsx)("button",{onClick:function(){y(!1)},children:"ADD NEW PRODUCT"}),Object(x.jsx)("button",{onClick:function(){y(!0)},children:"CANCEL"})]}),!m&&Object(x.jsx)(I,{fields:null===(t=i.find((function(e){return e.name===c.product})))||void 0===t?void 0:t.fields,handleSubmit:function(e){h((function(t){return t&&Array.isArray(t)?[].concat(Object(u.a)(t),[e]):[e]})),y(!0)},children:Object(x.jsx)("button",{type:"submit",children:"Register"})}),m&&f&&Array.isArray(f)&&Object(x.jsx)(I,{fields:null===(n=i.find((function(e){return e.name===c.customer})))||void 0===n?void 0:n.fields,handleSubmit:function(e){console.log(f,e)},children:Object(x.jsx)("button",{type:"submit",children:"Register"})})]}):null},A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,309)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))};l.a.render(Object(x.jsx)(i.a.StrictMode,{children:Object(x.jsx)(V,{})}),document.getElementById("root")),A()}},[[302,1,2]]]);
//# sourceMappingURL=main.2da368e4.chunk.js.map