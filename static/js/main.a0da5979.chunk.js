(this["webpackJsonpdynamic-form"]=this["webpackJsonpdynamic-form"]||[]).push([[0],{302:function(e,t,n){"use strict";n.r(t);var c,r,a=n(0),i=n.n(a),s=n(24),l=n.n(s),u=n(12),o=n(8),d=n(13),j=n.n(d),b=n(19);!function(e){e.product="product",e.serialNumber="serialNumber",e.date="date",e.file="file",e.textInput="textInput",e.email="email",e.country="country",e.state="state",e.phone="phone",e.dropdown="dropdown",e.checkboxes="checkboxes"}(c||(c={})),function(e){e.product="product",e.customer="customer"}(r||(r={}));var O=n(94),f=n(10),h=n(132),p=n.n(h),x=n(15),v=n(3),m=function(e){var t=e.name,n=e.id,c=e.values;return Object(v.jsxs)(x.b,{as:"select",name:t,id:n,children:[Object(v.jsx)("option",{}),c.map((function(e){return Object(v.jsx)("option",{value:e.value,label:e.label,children:e.label},e.id)}))]})},y=function(e){var t=e.name,n=e.values,c=e.id;return Object(v.jsx)("div",{role:"group",id:c,children:n.map((function(e){return Object(v.jsxs)("label",{children:[Object(v.jsx)("span",{children:e.label}),Object(v.jsx)(x.b,{type:"radio",id:e.id,name:t,value:e.value})]},e.id)}))})},g=function(e){var t=e.id,n=e.label,c=e.field,r=e.form,i=Object(a.useState)(""),s=Object(o.a)(i,2),l=s[0],u=s[1],d=Object(a.useState)(""),O=Object(o.a)(d,2),f=O[0],h=O[1],p=Object(a.useState)(!1),x=Object(o.a)(p,2),m=x[0],y=x[1],g=Object(a.useState)(!1),w=Object(o.a)(g,2),C=w[0],k=w[1],S=Object(a.useCallback)(Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){console.log("Fake api call..."),setTimeout((function(){Math.random()<.5?e({valid:!0}):e({valid:!1})}),2e3)})));case 1:case"end":return e.stop()}}),e)}))),[]),F=Object(a.useCallback)(Object(b.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(l),u(""),k(!0),e.next=5,S();case 5:t=e.sent,n=t.valid,r.setFieldValue(c.name,n?l:""),y(n),k(!1);case 10:case"end":return e.stop()}}),e)}))),[l,c.name,r,S]);return Object(v.jsxs)("div",{children:[f&&Object(v.jsxs)("div",{children:[Object(v.jsx)("b",{children:f})," ",Object(v.jsx)("span",{children:C?"Checking...":m?"OK":"FAILURE"})," ",Object(v.jsx)("button",{onClick:function(){h(""),r.setFieldValue(c.name,"")},children:"Clear"})]}),Object(v.jsxs)("label",{children:[Object(v.jsx)("span",{children:n}),Object(v.jsx)("input",{disabled:Boolean(f),type:"text",onKeyDown:function(e){e&&"Enter"===e.key&&F()},onBlur:F,onChange:function(e){return u(e.target.value)},value:l,id:t})]})]})},w=n(128),C=function(e){var t=e.country,n=e.field,c=e.form,r=e.disabled,i=Object(a.useState)([]),s=Object(o.a)(i,2),l=s[0],u=s[1];function d(){return(d=Object(b.a)(j.a.mark((function e(t){var n,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("states.json",{cache:"force-cache"});case 2:return n=e.sent,e.next=5,n.json();case 5:return c=e.sent,t&&t in c&&u(Object.entries(c[t]).map((function(e){var t=Object(o.a)(e,2);return{value:t[0],label:t[1]}}))),e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){!function(e){d.apply(this,arguments)}(t)}),[c,n,t]),Object(v.jsx)(w.a,{options:l,name:n.name,value:n.value,onChange:function(e){c.setFieldValue(n.name,e)},isDisabled:Boolean(r)})},k=n(53),S=n(37);function F(e){return e.reduce((function(e,t){return Object(f.a)(Object(f.a)({},e),{},Object(k.a)({},t.name,t.default||""))}),{})}function q(e){var t=e.reduce((function(e,t){var n=S.a((function(e){return t.type===c.product&&t.required?S.c().required("".concat(t.label," is a required field")).nullable():t.type===c.email&&t.required?S.d().email("Invalid email").required("".concat(t.label," is a required field")):t.required?S.d().required("".concat(t.label," is a required field")):S.b()}));return Object(f.a)(Object(f.a)({},e),{},Object(k.a)({},t.name,n))}),{});return S.c().shape(t)}n(251);var A=n(95),D=function(e){var t=e.fields,n=e.handleSubmit,r=e.children,a=function(e){return Object(v.jsxs)(v.Fragment,{children:[e.description&&Object(v.jsx)("div",{children:e.description}),Object(v.jsx)(x.a,{name:e.name})]})};return Object(v.jsx)(x.d,{initialValues:F(t),validationSchema:q(t),onSubmit:function(e){n(e)},children:function(e){return Object(v.jsxs)(x.c,{style:{marginBottom:30,marginTop:30},onSubmit:e.handleSubmit,children:[Object(v.jsx)(v.Fragment,{children:t.map((function(t){var n=[t.id,t.name,t.label].join("");switch(t.type){case c.textInput:case c.phone:case c.email:return Object(v.jsxs)("div",{children:[Object(v.jsx)("div",{children:Object(v.jsxs)("label",{children:[Object(v.jsx)("span",{children:t.label}),Object(v.jsx)(x.b,{name:t.name})]})}),a(t)]},n);case c.serialNumber:return Object(v.jsxs)("div",{children:[Object(v.jsx)(x.b,Object(f.a)({component:g},t)),a(t)]},n);case c.file:return Object(v.jsxs)("div",{children:[Object(v.jsx)("label",{children:t.label}),Object(v.jsx)("div",{children:Object(v.jsx)("input",{accept:t.accept,type:t.type,name:t.name,onChange:function(n){var c,r;e.setFieldValue(t.name,null===n||void 0===n||null===(c=n.target)||void 0===c||null===(r=c.files)||void 0===r?void 0:r[0])}})}),a(t)]},n);case c.checkboxes:var r=t.options,i=Object(O.a)(t,["options"]);return Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{children:[Object(v.jsx)("div",{children:t.label}),Object(v.jsx)(y,Object(f.a)(Object(f.a)({},i),{},{values:r}))]}),a(t)]},n);case c.dropdown:var s=t.options,l=Object(O.a)(t,["options"]);return Object(v.jsxs)("div",{children:[Object(v.jsxs)("label",{children:[Object(v.jsx)("span",{children:t.label}),Object(v.jsx)(m,Object(f.a)(Object(f.a)({},l),{},{values:s}))]}),a(t)]},n);case c.date:var u=e.values[t.name];return Object(v.jsxs)("div",{children:[Object(v.jsxs)("label",{children:[Object(v.jsx)("span",{children:t.label}),Object(v.jsx)(p.a,{selected:u?new Date(u):null,dateFormat:"MMMM d, yyyy",className:"form-control",name:"startDate",onChange:function(n){n&&e.setFieldValue(t.name,n.toString())}})]}),a(t)]},n);case c.product:return Object(v.jsxs)("div",{children:[Object(v.jsxs)("label",{children:[Object(v.jsx)("span",{children:t.label}),Object(v.jsx)(x.b,Object(f.a)(Object(f.a)({},t),{},{render:function(e){var t=e.field,n=e.form;return Object(v.jsx)(A.a,{cacheOptions:!0,formatOptionLabel:function(e){var t;return Object(v.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(v.jsx)("img",{width:32,src:null===e||void 0===e||null===(t=e.image)||void 0===t?void 0:t.src,alt:""}),Object(v.jsx)("span",{children:null===e||void 0===e?void 0:e.title})]})},isClearable:!0,defaultOptions:!0,name:t.name,value:t.value||"",isOptionSelected:function(e,t){return t.some((function(t){return t.variantId===e.variantId}))},onChange:function(e){return n.setFieldValue(t.name,e)},loadOptions:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("search.json?q=".concat(t));case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})}}))]}),a(t)]},n);case c.country:return Object(v.jsxs)("div",{children:[Object(v.jsxs)("label",{children:[Object(v.jsx)("span",{children:t.label}),Object(v.jsx)(x.b,Object(f.a)(Object(f.a)({},t),{},{render:function(e){var t=e.form,n=e.field;return Object(v.jsx)(A.a,{cacheOptions:!0,defaultOptions:!0,name:n.name,defaultValue:n.value,onChange:function(e){t.setFieldValue("state",""),t.setFieldValue(n.name,e.value)},loadOptions:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("countries.json",{cache:"force-cache"});case 2:return n=e.sent,e.next=5,n.json();case 5:return c=e.sent,e.abrupt("return",Object.entries(c).filter((function(e){var n=Object(o.a)(e,2);n[0];return n[1].toLowerCase().includes(t.toLowerCase())})).map((function(e){var t=Object(o.a)(e,2);return{value:t[0],label:t[1]}})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})}}))]}),a(t)]},n);case c.state:var d,h,w=null!==(d=null===(h=e.values)||void 0===h?void 0:h.country)&&void 0!==d?d:"";return Object(v.jsxs)("div",{children:[Object(v.jsxs)("label",{children:[Object(v.jsx)("span",{children:t.label}),Object(v.jsx)(x.b,Object(f.a)(Object(f.a)({},t),{},{country:w,render:function(e){return Object(v.jsx)(C,Object(f.a)({country:w},e))},disabled:!Boolean(w)}))]}),a(t)]},n);default:return Object(v.jsxs)("div",{children:["Not implemented field ",t.type]},n)}}))}),r]})}})},I=function(){var e,t,n,c=function(){var e=Object(a.useState)(),t=Object(o.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(),i=Object(o.a)(r,2),s=i[0],l=i[1],u=Object(a.useState)(!1),d=Object(o.a)(u,2),O=d[0],f=d[1],h=Object(a.useCallback)(Object(b.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.prev=1,e.next=4,fetch("form.json");case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,c(n),l(null),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),c(null),l(e.t0);case 16:return e.prev=16,f(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[1,12,16,19]])}))),[]);return Object(a.useEffect)((function(){h()}),[h]),{formData:n,error:s,loading:O}}(),i=c.formData,s=c.loading,l=c.error,d=Object(a.useState)(),O=Object(o.a)(d,2),f=O[0],h=O[1],p=Object(a.useState)(!1),x=Object(o.a)(p,2),m=x[0],y=x[1];return s?Object(v.jsx)("div",{children:"Loading..."}):l?Object(v.jsx)("div",{children:"Error..."}):i?Object(v.jsxs)(v.Fragment,{children:[f&&Array.isArray(f)&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("table",{style:{border:"solid",borderCollapse:"collapse",marginBottom:20},width:"100%",children:[Object(v.jsx)("thead",{children:Object(v.jsx)("tr",{children:null===(e=i.find((function(e){return e.name===r.product})))||void 0===e?void 0:e.fields.map((function(e){return Object(v.jsx)("th",{style:{border:"solid"},children:e.label},e.id)}))})}),Object(v.jsx)("tbody",{children:f.map((function(e,t){return Object(v.jsx)("tr",{children:Object.values(e).map((function(e,t){return Object(v.jsx)("td",{style:{border:"solid"},children:"object"===typeof e?"name"in e?e.name:Object(v.jsxs)("div",{style:{textAlign:"center"},children:[Object(v.jsx)("img",{width:32,src:e.image.src,alt:""}),Object(v.jsx)("div",{children:e.title})]}):e},t)}))},t)}))})]}),Object(v.jsx)("button",{onClick:function(){y(!1)},children:"ADD NEW PRODUCT"}),Object(v.jsx)("button",{onClick:function(){y(!0)},children:"CANCEL"})]}),!m&&Object(v.jsx)(D,{fields:null===(t=i.find((function(e){return e.name===r.product})))||void 0===t?void 0:t.fields,handleSubmit:function(e){h((function(t){return t&&Array.isArray(t)?[].concat(Object(u.a)(t),[e]):[e]})),y(!0)},children:Object(v.jsx)("button",{type:"submit",children:"Register"})}),m&&f&&Array.isArray(f)&&Object(v.jsx)(D,{fields:null===(n=i.find((function(e){return e.name===r.customer})))||void 0===n?void 0:n.fields,handleSubmit:function(e){console.log(f,e)},children:Object(v.jsx)("button",{type:"submit",children:"Register"})})]}):null},V=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,309)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};l.a.render(Object(v.jsx)(i.a.StrictMode,{children:Object(v.jsx)(I,{})}),document.getElementById("root")),V()}},[[302,1,2]]]);
//# sourceMappingURL=main.a0da5979.chunk.js.map